accelerator:
  displayName: Web Function with GoLang or Spring Native
  description: Accelerator to create a simple web Function 
  iconUrl: https://raw.githubusercontent.com/dektlong/dekt-images/80bfdbf23040731d16310e286e7d40b57e3b23d5/tanzu.png
  tags:
  - cloud-native-devs

  options:
  
  - name: gitRepo
    label: Source repository
    required: true
    dataType: string
    defaultValue: my-function
    
  #function framework
  - name: functionFramework
    label: Framework
    description: Function implementation framework
    required: true
    defaultValue: go
    inputType: select
    choices:
      - value: go
        text: GoLang
      - value: spring
        text: Spring Native
  
  #app deployment
  #- name: appDeploymentType
  #  label: Deployment environment
  #  description: Type of deployment configurations
  #  required: true
  #  defaultValue: tap
  #  inputType: select
  #  choices:
      #- value: k8s
      #  text: K8s simple
   #   - value: tap
   #     text: Tanzu Application Platform workload
   #   - value: kNative
   #     text: kNative serving
           
  #- name: scaleToZero
  #  label: Scale to zero
  #  description: Enable function to scale to zero
  #  inputType: toggle
  #  dataType: boolean
  #  defaultValue: false
   
engine:
  merge:
    #generic transformations
    - includes: ["README.MD"]
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
    #go framework
    - includes: [ "go/**" ]
      condition: "#functionFramework == 'go'"
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
    #java-native framework
    - includes: [ "java-native/**" ]
      condition: "#functionFramework == 'spring'"
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
   #deployments
    #- includes: [ "config/app-knative.yaml"]
    #  condition: "#appDeploymentType == 'kNative'"
    #  chain:
    #    - type: YTT
    - includes: [ "config/workload.yaml"]
     # condition: "#appDeploymentType == 'tap'"
      chain:
        - type: YTT
    #- includes: [ "config/app-simple.yaml"]
    #  condition: "#appDeploymentType == 'k8s'"
    #  chain:
    #    - type: YTT
